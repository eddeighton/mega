
///////////////////////////////////////////
///////////////////////////////////////////
// Stages
stage perprogram ComponentListing
{
    file Components
}

stage perobject InputParse
{
    file AST
    file Body

    accessor perprogram array< ref< Components::Component > >
}

stage perobject Interface
{
    file Tree

    accessor perobject ref< Parser::Root >
}

stage perprogram Dependencies
{
    file DependencyAnalysis

    accessor perobject ref< Interface::Root >
}

stage perobject Analysis
{
    file ObjectCompile
    file ObjectAnalysis
}

stage perprogram Concrete
{
    file Tree
}

stage perprogram Layout
{
    file Buffers
}

stage perprogram HyperGraph
{
    file Graph
}

stage perprogram Derivations
{
    file Invocations
}

///////////////////////////////////////////
///////////////////////////////////////////
// Objects
namespace Components
{
    object Component -> ComponentListing::Components
    {
        value< std::string > name
        value< boost::filesystem::path > directory
        array< value< boost::filesystem::path > > includeDirectories
        array< value< boost::filesystem::path > > sourceFiles
    }
}

namespace Parser
{
    object Opaque -> InputParse::AST
    {
        value< std::string > str
    }

    object Dimension -> InputParse::AST
    {
        value< bool > isConst
        value< std::string > identifier
        value< std::string > type
        value< std::string > foobar -> Interface::Tree
    }

    object Root : Context -> InputParse::AST
    {
    }

    object Context -> InputParse::AST
    {
        value< std::string > identifier
        value< std::string > body -> InputParse::Body
    }

    object FoobarRoot : TestRoot -> InputParse::AST
    {
    }

    object TestRoot : Root -> InputParse::AST
    {
    }
}

namespace Interface
{
    object Root -> Interface::Tree
    {
        //ref< Parser::Root > root
    }
}
